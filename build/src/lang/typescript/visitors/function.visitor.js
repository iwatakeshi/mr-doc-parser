"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Node_1 = require("../Node");
const match_1 = require("../../../utils/match");
const call_signature_visitor_1 = require("./call_signature.visitor");
function visitFunction(source, node, comment, properties) {
    let children = node.children;
    let isAync = false, identifier, type_parameters, formal_parameters, type_annotation;
    if (match_1.default(children[0], 'async')) {
        isAync = true;
        children.shift();
    }
    if (match_1.default(children[0], 'function')) {
        children.shift();
    }
    if (match_1.default(children[0], 'identifier')) {
        identifier = Node_1.createNode(source, children.shift());
    }
    if (match_1.default(children[0], 'call_signature')) {
        let call_signature = call_signature_visitor_1.visitCallSignature(source, children.shift());
        type_parameters = call_signature.type_parameters;
        formal_parameters = call_signature.formal_parameters;
        type_annotation = call_signature.type_annotation;
    }
    return {
        type: 'function',
        context: Node_1.createNode(source, node, properties),
        comment: Node_1.createNode(source, comment, null, true),
        isAync,
        identifier,
        type_parameters,
        formal_parameters,
        type_annotation,
        properties
    };
}
exports.visitFunction = visitFunction;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZnVuY3Rpb24udmlzaXRvci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9sYW5nL3R5cGVzY3JpcHQvdmlzaXRvcnMvZnVuY3Rpb24udmlzaXRvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLGtDQUFxRDtBQUNyRCxnREFBeUM7QUFDekMscUVBQThEO0FBRzlELFNBQWdCLGFBQWEsQ0FDekIsTUFBYSxFQUNiLElBQWdCLEVBQ2hCLE9BQW1CLEVBQ25CLFVBQW1DO0lBRW5DLElBQUksUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7SUFDN0IsSUFBSSxNQUFNLEdBQUcsS0FBSyxFQUNkLFVBQVUsRUFDVixlQUFlLEVBQ2YsaUJBQWlCLEVBQ2pCLGVBQWUsQ0FBQztJQUVwQixJQUFJLGVBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUUsT0FBTyxDQUFDLEVBQUU7UUFDN0IsTUFBTSxHQUFHLElBQUksQ0FBQztRQUNkLFFBQVEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztLQUNwQjtJQUVELElBQUksZUFBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBRSxVQUFVLENBQUMsRUFBRTtRQUNoQyxRQUFRLENBQUMsS0FBSyxFQUFFLENBQUM7S0FDcEI7SUFFRCxJQUFJLGVBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUUsWUFBWSxDQUFDLEVBQUU7UUFDbEMsVUFBVSxHQUFHLGlCQUFVLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFBO0tBQ3BEO0lBRUQsSUFBSSxlQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxFQUFFLGdCQUFnQixDQUFDLEVBQUU7UUFDdEMsSUFBSSxjQUFjLEdBQUcsMkNBQWtCLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFBO1FBQ2pFLGVBQWUsR0FBRyxjQUFjLENBQUMsZUFBZSxDQUFDO1FBQ2pELGlCQUFpQixHQUFHLGNBQWMsQ0FBQyxpQkFBaUIsQ0FBQztRQUNyRCxlQUFlLEdBQUcsY0FBYyxDQUFDLGVBQWUsQ0FBQztLQUNwRDtJQUVELE9BQU87UUFDSCxJQUFJLEVBQUUsVUFBVTtRQUNoQixPQUFPLEVBQUUsaUJBQVUsQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLFVBQVUsQ0FBQztRQUM3QyxPQUFPLEVBQUUsaUJBQVUsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7UUFDaEQsTUFBTTtRQUNOLFVBQVU7UUFDVixlQUFlO1FBQ2YsaUJBQWlCO1FBQ2pCLGVBQWU7UUFDZixVQUFVO0tBQ2IsQ0FBQTtBQUVMLENBQUM7QUE3Q0Qsc0NBNkNDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU3ludGF4Tm9kZSB9IGZyb20gXCJ0cmVlLXNpdHRlclwiO1xyXG5pbXBvcnQgeyBOb2RlUHJvcGVydGllcywgY3JlYXRlTm9kZSB9IGZyb20gXCIuLi9Ob2RlXCI7XHJcbmltcG9ydCBtYXRjaCBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvbWF0Y2hcIjtcclxuaW1wb3J0IHsgdmlzaXRDYWxsU2lnbmF0dXJlIH0gZnJvbSBcIi4vY2FsbF9zaWduYXR1cmUudmlzaXRvclwiO1xyXG5pbXBvcnQgSUZpbGUgZnJvbSBcIi4uLy4uLy4uL2ludGVyZmFjZXMvSUZpbGVcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB2aXNpdEZ1bmN0aW9uKFxyXG4gICAgc291cmNlOiBJRmlsZSxcclxuICAgIG5vZGU6IFN5bnRheE5vZGUsXHJcbiAgICBjb21tZW50OiBTeW50YXhOb2RlLFxyXG4gICAgcHJvcGVydGllczogUGFydGlhbDxOb2RlUHJvcGVydGllcz5cclxuKSB7XHJcbiAgICBsZXQgY2hpbGRyZW4gPSBub2RlLmNoaWxkcmVuO1xyXG4gICAgbGV0IGlzQXluYyA9IGZhbHNlLFxyXG4gICAgICAgIGlkZW50aWZpZXIsXHJcbiAgICAgICAgdHlwZV9wYXJhbWV0ZXJzLFxyXG4gICAgICAgIGZvcm1hbF9wYXJhbWV0ZXJzLFxyXG4gICAgICAgIHR5cGVfYW5ub3RhdGlvbjtcclxuXHJcbiAgICBpZiAobWF0Y2goY2hpbGRyZW5bMF0sICdhc3luYycpKSB7XHJcbiAgICAgICAgaXNBeW5jID0gdHJ1ZTtcclxuICAgICAgICBjaGlsZHJlbi5zaGlmdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChtYXRjaChjaGlsZHJlblswXSwgJ2Z1bmN0aW9uJykpIHtcclxuICAgICAgICBjaGlsZHJlbi5zaGlmdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChtYXRjaChjaGlsZHJlblswXSwgJ2lkZW50aWZpZXInKSkge1xyXG4gICAgICAgIGlkZW50aWZpZXIgPSBjcmVhdGVOb2RlKHNvdXJjZSwgY2hpbGRyZW4uc2hpZnQoKSlcclxuICAgIH1cclxuXHJcbiAgICBpZiAobWF0Y2goY2hpbGRyZW5bMF0sICdjYWxsX3NpZ25hdHVyZScpKSB7XHJcbiAgICAgICAgbGV0IGNhbGxfc2lnbmF0dXJlID0gdmlzaXRDYWxsU2lnbmF0dXJlKHNvdXJjZSwgY2hpbGRyZW4uc2hpZnQoKSlcclxuICAgICAgICB0eXBlX3BhcmFtZXRlcnMgPSBjYWxsX3NpZ25hdHVyZS50eXBlX3BhcmFtZXRlcnM7XHJcbiAgICAgICAgZm9ybWFsX3BhcmFtZXRlcnMgPSBjYWxsX3NpZ25hdHVyZS5mb3JtYWxfcGFyYW1ldGVycztcclxuICAgICAgICB0eXBlX2Fubm90YXRpb24gPSBjYWxsX3NpZ25hdHVyZS50eXBlX2Fubm90YXRpb247XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB0eXBlOiAnZnVuY3Rpb24nLFxyXG4gICAgICAgIGNvbnRleHQ6IGNyZWF0ZU5vZGUoc291cmNlLCBub2RlLCBwcm9wZXJ0aWVzKSxcclxuICAgICAgICBjb21tZW50OiBjcmVhdGVOb2RlKHNvdXJjZSwgY29tbWVudCwgbnVsbCwgdHJ1ZSksXHJcbiAgICAgICAgaXNBeW5jLFxyXG4gICAgICAgIGlkZW50aWZpZXIsXHJcbiAgICAgICAgdHlwZV9wYXJhbWV0ZXJzLFxyXG4gICAgICAgIGZvcm1hbF9wYXJhbWV0ZXJzLFxyXG4gICAgICAgIHR5cGVfYW5ub3RhdGlvbixcclxuICAgICAgICBwcm9wZXJ0aWVzXHJcbiAgICB9XHJcblxyXG59Il19