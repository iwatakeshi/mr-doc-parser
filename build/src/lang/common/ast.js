"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const text_1 = require("../../utils/text");
const range_1 = require("../../utils/range");
const xdoc_parser_1 = require("xdoc-parser");
const _ = require("lodash");
function isASTNode(object) {
    return object && 'type' in object && 'text' in object && 'children' in object;
}
exports.isASTNode = isASTNode;
function createASTNode(source, node, arg1, arg2) {
    let context, children = [], document = typeof arg2 === 'boolean' && arg2 === true, properties;
    if (_.isPlainObject(arg1) && !isASTNode(arg1)) {
        properties = arg1;
    }
    else if (_.isPlainObject(arg1) && isASTNode(arg1)) {
        context = arg1;
    }
    else if (_.isArray(arg1)) {
        children = arg1;
    }
    if (_.isPlainObject(arg2)) {
        properties = arg2;
    }
    return Object.assign({ type: node.type, text: text_1.text(source, node) }, range_1.default(node), { context,
        children, comment: document ? xdoc_parser_1.default(source.text).parse() : undefined, properties });
}
exports.createASTNode = createASTNode;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xhbmcvY29tbW9uL2FzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLDJDQUF3QztBQUN4Qyw2Q0FBc0M7QUFFdEMsNkNBQStCO0FBQy9CLDRCQUEyQjtBQUczQixTQUFnQixTQUFTLENBQUMsTUFBYztJQUN0QyxPQUFPLE1BQU0sSUFBSSxNQUFNLElBQUksTUFBTSxJQUFJLE1BQU0sSUFBSSxNQUFNLElBQUksVUFBVSxJQUFJLE1BQU0sQ0FBQztBQUNoRixDQUFDO0FBRkQsOEJBRUM7QUFPRCxTQUFnQixhQUFhLENBQUMsTUFBYyxFQUFFLElBQWdCLEVBQUUsSUFBVSxFQUFFLElBQVU7SUFFcEYsSUFBSSxPQUFPLEVBQUUsUUFBUSxHQUFHLEVBQUUsRUFBRSxRQUFRLEdBQUcsT0FBTyxJQUFJLEtBQUssU0FBUyxJQUFJLElBQUksS0FBSyxJQUFJLEVBQUUsVUFBVSxDQUFDO0lBRTlGLElBQUksQ0FBQyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRTtRQUM3QyxVQUFVLEdBQUcsSUFBSSxDQUFDO0tBQ25CO1NBQU0sSUFBSSxDQUFDLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRTtRQUNuRCxPQUFPLEdBQUcsSUFBSSxDQUFDO0tBQ2hCO1NBQU0sSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQzFCLFFBQVEsR0FBRyxJQUFJLENBQUM7S0FDakI7SUFFRCxJQUFJLENBQUMsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDekIsVUFBVSxHQUFHLElBQUksQ0FBQztLQUNuQjtJQUVELHVCQUNFLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxFQUNmLElBQUksRUFBRSxXQUFJLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxJQUNyQixlQUFLLENBQUMsSUFBSSxDQUFDLElBQ2QsT0FBTztRQUNQLFFBQVEsRUFDUixPQUFPLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxxQkFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUN6RCxVQUFVLElBQ1g7QUFDSCxDQUFDO0FBekJELHNDQXlCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFN5bnRheE5vZGUgfSBmcm9tIFwidHJlZS1zaXR0ZXJcIjtcclxuaW1wb3J0IHsgdGV4dCB9IGZyb20gXCIuLi8uLi91dGlscy90ZXh0XCI7XHJcbmltcG9ydCByYW5nZSBmcm9tIFwiLi4vLi4vdXRpbHMvcmFuZ2VcIjtcclxuaW1wb3J0IFNvdXJjZSBmcm9tIFwiLi4vLi4vaW50ZXJmYWNlcy9Tb3VyY2VcIjtcclxuaW1wb3J0IHhkb2MgZnJvbSAneGRvYy1wYXJzZXInO1xyXG5pbXBvcnQgKiBhcyBfIGZyb20gJ2xvZGFzaCdcclxuaW1wb3J0IEFTVE5vZGUgZnJvbSBcIi4uLy4uL2ludGVyZmFjZXMvQVNUTm9kZVwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzQVNUTm9kZShvYmplY3Q6IG9iamVjdCk6IG9iamVjdCBpcyBBU1ROb2RlIHtcclxuICByZXR1cm4gb2JqZWN0ICYmICd0eXBlJyBpbiBvYmplY3QgJiYgJ3RleHQnIGluIG9iamVjdCAmJiAnY2hpbGRyZW4nIGluIG9iamVjdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUFTVE5vZGUoc291cmNlOiBTb3VyY2UsIG5vZGU6IFN5bnRheE5vZGUpOiBBU1ROb2RlXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBU1ROb2RlKHNvdXJjZTogU291cmNlLCBub2RlOiBTeW50YXhOb2RlLCBwcm9wZXJ0aWVzOiBvYmplY3QpXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBU1ROb2RlKHNvdXJjZTogU291cmNlLCBub2RlOiBTeW50YXhOb2RlLCBjaGlsZHJlbjogb2JqZWN0W10pOiBBU1ROb2RlXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBU1ROb2RlKHNvdXJjZTogU291cmNlLCBub2RlOiBTeW50YXhOb2RlLCBjaGlsZHJlbjogb2JqZWN0W10sIHByb3BlcnRpZXM6IG9iamVjdClcclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUFTVE5vZGUoc291cmNlOiBTb3VyY2UsIG5vZGU6IFN5bnRheE5vZGUsIGNvbnRleHQ6IEFTVE5vZGUsIGRvY3VtZW50OiBib29sZWFuKTogQVNUTm9kZVxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQVNUTm9kZShzb3VyY2U6IFNvdXJjZSwgbm9kZTogU3ludGF4Tm9kZSwgYXJnMT86IGFueSwgYXJnMj86IGFueSk6IEFTVE5vZGUge1xyXG5cclxuICBsZXQgY29udGV4dCwgY2hpbGRyZW4gPSBbXSwgZG9jdW1lbnQgPSB0eXBlb2YgYXJnMiA9PT0gJ2Jvb2xlYW4nICYmIGFyZzIgPT09IHRydWUsIHByb3BlcnRpZXM7XHJcblxyXG4gIGlmIChfLmlzUGxhaW5PYmplY3QoYXJnMSkgJiYgIWlzQVNUTm9kZShhcmcxKSkge1xyXG4gICAgcHJvcGVydGllcyA9IGFyZzE7XHJcbiAgfSBlbHNlIGlmIChfLmlzUGxhaW5PYmplY3QoYXJnMSkgJiYgaXNBU1ROb2RlKGFyZzEpKSB7XHJcbiAgICBjb250ZXh0ID0gYXJnMTtcclxuICB9IGVsc2UgaWYgKF8uaXNBcnJheShhcmcxKSkge1xyXG4gICAgY2hpbGRyZW4gPSBhcmcxO1xyXG4gIH1cclxuXHJcbiAgaWYgKF8uaXNQbGFpbk9iamVjdChhcmcyKSkge1xyXG4gICAgcHJvcGVydGllcyA9IGFyZzI7XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgdHlwZTogbm9kZS50eXBlLFxyXG4gICAgdGV4dDogdGV4dChzb3VyY2UsIG5vZGUpLFxyXG4gICAgLi4ucmFuZ2Uobm9kZSksXHJcbiAgICBjb250ZXh0LFxyXG4gICAgY2hpbGRyZW4sXHJcbiAgICBjb21tZW50OiBkb2N1bWVudCA/IHhkb2Moc291cmNlLnRleHQpLnBhcnNlKCkgOiB1bmRlZmluZWQsXHJcbiAgICBwcm9wZXJ0aWVzLFxyXG4gIH1cclxufVxyXG4iXX0=