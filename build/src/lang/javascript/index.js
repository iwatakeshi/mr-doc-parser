"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Parser = require("tree-sitter");
const JavaScript = require("tree-sitter-javascript");
const visitor_1 = require("./visitor");
const walk_1 = require("../../utils/walk");
/**
 * A class that parses JavaScript comments.
 *
 * # API
 *
 * ```
 * @class JavaScriptParser
 * @implements IParser
 * @export default
 * ```
 */
class JavaScriptParser {
    constructor(source, options) {
        this.source = source;
        Object.assign(this.options = {}, options || {});
        this.parser = new Parser();
        this.parser.setLanguage(JavaScript);
        this.tree_ = this.parser.parse(this.source.text);
    }
    parse() {
        const visitor = new visitor_1.JavaScriptVisitor(this.source);
        const root = walk_1.default(this.tree.rootNode);
        // console.time('visit')
        root.visit(visitor);
        // console.timeEnd('visit')
        return visitor.getAST();
    }
    get tree() {
        return this.tree_;
    }
}
exports.default = JavaScriptParser;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbGFuZy9qYXZhc2NyaXB0L2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsc0NBQXNDO0FBQ3RDLHFEQUFxRDtBQUlyRCx1Q0FBOEM7QUFDOUMsMkNBQW9DO0FBRXBDOzs7Ozs7Ozs7O0dBVUc7QUFDSCxNQUFxQixnQkFBZ0I7SUFNbkMsWUFBWSxNQUFjLEVBQUUsT0FBWTtRQUN0QyxJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztRQUNyQixNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLEdBQUcsRUFBRSxFQUFFLE9BQU8sSUFBSSxFQUFFLENBQUMsQ0FBQztRQUNoRCxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksTUFBTSxFQUFFLENBQUM7UUFDM0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDcEMsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25ELENBQUM7SUFDRCxLQUFLO1FBQ0gsTUFBTSxPQUFPLEdBQUcsSUFBSSwyQkFBaUIsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDbkQsTUFBTSxJQUFJLEdBQUcsY0FBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDdEMsd0JBQXdCO1FBQ3hCLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUE7UUFDbkIsMkJBQTJCO1FBQzNCLE9BQU8sT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQzFCLENBQUM7SUFDRCxJQUFJLElBQUk7UUFDTixPQUFPLElBQUksQ0FBQyxLQUFLLENBQUM7SUFDcEIsQ0FBQztDQUNGO0FBeEJELG1DQXdCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFBhcnNlciBmcm9tICd0cmVlLXNpdHRlcic7XHJcbmltcG9ydCAqIGFzIEphdmFTY3JpcHQgZnJvbSAndHJlZS1zaXR0ZXItamF2YXNjcmlwdCc7XHJcbmltcG9ydCBQYXJzZXJJbnRlcmZhY2UgZnJvbSAnLi4vLi4vaW50ZXJmYWNlcy9QYXJzZXJJbnRlcmZhY2UnO1xyXG5pbXBvcnQgU291cmNlIGZyb20gJy4uLy4uL2ludGVyZmFjZXMvU291cmNlJztcclxuaW1wb3J0IHsgQVNUTm9kZSB9IGZyb20gJy4uL2NvbW1vbi9hc3QnO1xyXG5pbXBvcnQgeyBKYXZhU2NyaXB0VmlzaXRvciB9IGZyb20gJy4vdmlzaXRvcic7XHJcbmltcG9ydCB3YWxrIGZyb20gJy4uLy4uL3V0aWxzL3dhbGsnO1xyXG5cclxuLyoqXHJcbiAqIEEgY2xhc3MgdGhhdCBwYXJzZXMgSmF2YVNjcmlwdCBjb21tZW50cy5cclxuICogXHJcbiAqICMgQVBJXHJcbiAqIFxyXG4gKiBgYGBcclxuICogQGNsYXNzIEphdmFTY3JpcHRQYXJzZXJcclxuICogQGltcGxlbWVudHMgSVBhcnNlclxyXG4gKiBAZXhwb3J0IGRlZmF1bHRcclxuICogYGBgXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBKYXZhU2NyaXB0UGFyc2VyIGltcGxlbWVudHMgUGFyc2VySW50ZXJmYWNlIHtcclxuICBcclxuICBwcml2YXRlIHNvdXJjZTogU291cmNlO1xyXG4gIHByaXZhdGUgb3B0aW9uczogYW55O1xyXG4gIHByaXZhdGUgcGFyc2VyOiBQYXJzZXI7XHJcbiAgcHJpdmF0ZSB0cmVlXzogUGFyc2VyLlRyZWU7XHJcbiAgY29uc3RydWN0b3Ioc291cmNlOiBTb3VyY2UsIG9wdGlvbnM6IGFueSkge1xyXG4gICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XHJcbiAgICBPYmplY3QuYXNzaWduKHRoaXMub3B0aW9ucyA9IHt9LCBvcHRpb25zIHx8IHt9KTtcclxuICAgIHRoaXMucGFyc2VyID0gbmV3IFBhcnNlcigpO1xyXG4gICAgdGhpcy5wYXJzZXIuc2V0TGFuZ3VhZ2UoSmF2YVNjcmlwdCk7XHJcbiAgICB0aGlzLnRyZWVfID0gdGhpcy5wYXJzZXIucGFyc2UodGhpcy5zb3VyY2UudGV4dCk7XHJcbiAgfVxyXG4gIHBhcnNlKCk6IEFTVE5vZGVbXSB7XHJcbiAgICBjb25zdCB2aXNpdG9yID0gbmV3IEphdmFTY3JpcHRWaXNpdG9yKHRoaXMuc291cmNlKTtcclxuICAgIGNvbnN0IHJvb3QgPSB3YWxrKHRoaXMudHJlZS5yb290Tm9kZSk7XHJcbiAgICAvLyBjb25zb2xlLnRpbWUoJ3Zpc2l0JylcclxuICAgIHJvb3QudmlzaXQodmlzaXRvcilcclxuICAgIC8vIGNvbnNvbGUudGltZUVuZCgndmlzaXQnKVxyXG4gICAgcmV0dXJuIHZpc2l0b3IuZ2V0QVNUKCk7XHJcbiAgfVxyXG4gIGdldCB0cmVlICgpOiBQYXJzZXIuVHJlZSB7XHJcbiAgICByZXR1cm4gdGhpcy50cmVlXztcclxuICB9XHJcbn0iXX0=